# ═══════════════════════════════════════════════════════════════════════════════
# ملف متغيرات البيئة - Environment Variables
# ═══════════════════════════════════════════════════════════════════════════════
#
# ⚠️ تحذير مهم:
# هذا الملف (.env.example) هو نموذج فقط - لا يحتوي على قيم حقيقية
# انسخه إلى .env واملأ القيم الحقيقية
# 
# الأمر: cp .env.example .env
#
# ⚠️ لا ترفع ملف .env إلى Git أبداً!
# ═══════════════════════════════════════════════════════════════════════════════


# ─────────────────────────────────────────────────────────────────────────────
# 🏠 إعدادات التطبيق الأساسية
# ─────────────────────────────────────────────────────────────────────────────

# اسم التطبيق - يظهر في السجلات والـ API docs
APP_NAME=Rafiq

# البيئة الحالية
# development = التطوير (سجلات مفصلة، أخطاء مفصلة)
# staging = الاختبار (بيئة تشبه الإنتاج)
# production = الإنتاج (سجلات محدودة، أمان أعلى)
NODE_ENV=development

# المنفذ الذي يستمع عليه الخادم
# عادة 3000 للتطوير، 80 أو 443 للإنتاج
PORT=3000

# رابط الـ API الأساسي (بدون / في النهاية)
# مثال للتطوير: http://localhost:3000
# مثال للإنتاج: https://api.rafiq.sa
API_URL=http://localhost:3000

# رابط الواجهة الأمامية (Frontend)
# يُستخدم لـ CORS وروابط البريد الإلكتروني
FRONTEND_URL=http://localhost:3001

# هل التطبيق خلف Proxy (مثل Nginx أو Load Balancer)؟
# true = نثق بـ X-Forwarded-* headers
# مهم للحصول على IP الحقيقي للمستخدم
TRUST_PROXY=false


# ─────────────────────────────────────────────────────────────────────────────
# 🗄️ قاعدة البيانات PostgreSQL
# ─────────────────────────────────────────────────────────────────────────────
#
# PostgreSQL = قاعدة بيانات علائقية قوية ومفتوحة المصدر
# تدعم: JSON, Full-text search, GIS, وأكثر
#
# لماذا PostgreSQL وليس MySQL؟
# - أداء أفضل مع الـ JSON
# - دعم أفضل للـ transactions
# - ميزات متقدمة أكثر
# ─────────────────────────────────────────────────────────────────────────────

# عنوان خادم قاعدة البيانات
# localhost للتطوير، أو عنوان IP/hostname للإنتاج
DB_HOST=localhost

# منفذ PostgreSQL (الافتراضي: 5432)
DB_PORT=5432

# اسم قاعدة البيانات
DB_NAME=rafiq_db

# اسم المستخدم
DB_USERNAME=rafiq_user

# كلمة المرور
# ⚠️ استخدم كلمة مرور قوية في الإنتاج!
DB_PASSWORD=rafiq_secret_password

# هل نستخدم SSL للاتصال؟
# true للإنتاج (خاصة مع قواعد البيانات السحابية)
# false للتطوير المحلي
DB_SSL=false

# هل نزامن الـ schema تلقائياً؟
# true = TypeORM ينشئ/يعدل الجداول تلقائياً
# ⚠️ استخدم false في الإنتاج! استخدم migrations بدلاً من ذلك
DB_SYNCHRONIZE=true

# هل نسجل استعلامات SQL؟
# true = كل استعلام يظهر في السجلات (مفيد للتطوير)
# false = لا نسجل (أفضل للإنتاج - أداء أفضل)
DB_LOGGING=true


# ─────────────────────────────────────────────────────────────────────────────
# 🔴 خادم Redis
# ─────────────────────────────────────────────────────────────────────────────
#
# Redis = مخزن بيانات في الذاكرة (In-Memory Data Store)
# سريع جداً! يُستخدم لـ:
# - التخزين المؤقت (Caching)
# - الجلسات (Sessions)
# - الطوابير (Queues)
# - Pub/Sub للرسائل الفورية
# ─────────────────────────────────────────────────────────────────────────────

# عنوان خادم Redis
REDIS_HOST=localhost

# منفذ Redis (الافتراضي: 6379)
REDIS_PORT=6379

# كلمة مرور Redis (اختياري للتطوير، مطلوب للإنتاج)
REDIS_PASSWORD=

# رقم قاعدة البيانات (Redis يدعم 16 قاعدة: 0-15)
# نستخدم قواعد مختلفة لأغراض مختلفة:
REDIS_DB=0

# مدة صلاحية التخزين المؤقت بالثواني
# 3600 = ساعة واحدة
REDIS_CACHE_TTL=3600


# ─────────────────────────────────────────────────────────────────────────────
# 🔑 المصادقة (Authentication) - JWT
# ─────────────────────────────────────────────────────────────────────────────
#
# JWT = JSON Web Token
# طريقة لتوثيق المستخدمين بدون حفظ الجلسات في الخادم
#
# كيف يعمل؟
# 1. المستخدم يسجل دخوله (email + password)
# 2. الخادم يرسل له token (نص مشفر)
# 3. المستخدم يرسل هذا الـ token مع كل طلب
# 4. الخادم يتحقق من الـ token ويعرف من هو المستخدم
# ─────────────────────────────────────────────────────────────────────────────

# المفتاح السري لتوقيع JWT
# ⚠️ مهم جداً: استخدم قيمة عشوائية طويلة في الإنتاج!
# يمكنك توليدها بـ: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# مدة صلاحية Access Token
# 15m = 15 دقيقة (قصير للأمان)
JWT_ACCESS_EXPIRATION=15m

# مدة صلاحية Refresh Token
# 7d = 7 أيام (يُستخدم لتجديد الـ Access Token)
JWT_REFRESH_EXPIRATION=7d

# خوارزمية التشفير
# HS256 = HMAC-SHA256 (الأكثر شيوعاً)
JWT_ALGORITHM=HS256


# ─────────────────────────────────────────────────────────────────────────────
# 🛒 منصة سلة (Salla)
# ─────────────────────────────────────────────────────────────────────────────
#
# سلة = منصة التجارة الإلكترونية السعودية
# نتكامل معها عبر OAuth2 و Webhooks
#
# للحصول على هذه المفاتيح:
# 1. سجل كمطور في: https://salla.partners
# 2. أنشئ تطبيق جديد
# 3. احصل على Client ID و Client Secret
# ─────────────────────────────────────────────────────────────────────────────

# معرف التطبيق في سلة
SALLA_CLIENT_ID=

# المفتاح السري للتطبيق
SALLA_CLIENT_SECRET=

# رابط إعادة التوجيه بعد OAuth
# مثال: https://api.rafiq.sa/api/v1/stores/salla/callback
SALLA_REDIRECT_URI=http://localhost:3000/api/v1/stores/salla/callback

# المفتاح السري للتحقق من Webhooks
# سلة ترسل هذا المفتاح مع كل webhook للتأكد من صحته
SALLA_WEBHOOK_SECRET=

# رابط API سلة
SALLA_API_URL=https://api.salla.dev/admin/v2


# ─────────────────────────────────────────────────────────────────────────────
# 💬 واتساب (WhatsApp Business API)
# ─────────────────────────────────────────────────────────────────────────────
#
# نستخدم WhatsApp Cloud API من Meta
# 
# للحصول على المفاتيح:
# 1. اذهب إلى: https://developers.facebook.com
# 2. أنشئ تطبيق Business
# 3. أضف منتج WhatsApp
# 4. احصل على Access Token و Phone Number ID
# ─────────────────────────────────────────────────────────────────────────────

# رمز الوصول للـ API
WHATSAPP_ACCESS_TOKEN=

# معرف رقم الهاتف المرسل
WHATSAPP_PHONE_NUMBER_ID=

# معرف حساب الأعمال
WHATSAPP_BUSINESS_ACCOUNT_ID=

# المفتاح للتحقق من Webhooks
WHATSAPP_WEBHOOK_VERIFY_TOKEN=

# المفتاح السري لفك تشفير رسائل Webhook
WHATSAPP_APP_SECRET=

# إصدار الـ API
WHATSAPP_API_VERSION=v18.0


# ─────────────────────────────────────────────────────────────────────────────
# 📸 إنستجرام (Instagram Graph API)
# ─────────────────────────────────────────────────────────────────────────────
#
# نستخدم Instagram Graph API للرد على الرسائل
# يتطلب حساب Instagram Business متصل بـ Facebook Page
# ─────────────────────────────────────────────────────────────────────────────

# رمز وصول الصفحة
INSTAGRAM_ACCESS_TOKEN=

# معرف حساب Instagram Business
INSTAGRAM_BUSINESS_ACCOUNT_ID=

# المفتاح للتحقق من Webhooks
INSTAGRAM_WEBHOOK_VERIFY_TOKEN=

# المفتاح السري للتطبيق
INSTAGRAM_APP_SECRET=


# ─────────────────────────────────────────────────────────────────────────────
# 🎮 ديسكورد (Discord Bot)
# ─────────────────────────────────────────────────────────────────────────────
#
# للحصول على المفاتيح:
# 1. اذهب إلى: https://discord.com/developers
# 2. أنشئ Application جديد
# 3. أنشئ Bot وفعّل الصلاحيات المطلوبة
# ─────────────────────────────────────────────────────────────────────────────

# رمز البوت السري
DISCORD_BOT_TOKEN=

# معرف التطبيق
DISCORD_CLIENT_ID=

# المفتاح السري للتطبيق
DISCORD_CLIENT_SECRET=

# المفتاح العام للتحقق من التفاعلات
DISCORD_PUBLIC_KEY=


# ─────────────────────────────────────────────────────────────────────────────
# 🤖 الذكاء الاصطناعي - OpenAI
# ─────────────────────────────────────────────────────────────────────────────
#
# نستخدم OpenAI لـ:
# - روبوت الدعم الذكي (Chat)
# - تحليل نوايا العملاء
# - توليد ردود مخصصة
#
# للحصول على المفتاح:
# 1. سجل في: https://platform.openai.com
# 2. اذهب إلى API Keys
# 3. أنشئ مفتاح جديد
# ─────────────────────────────────────────────────────────────────────────────

# مفتاح API
OPENAI_API_KEY=sk-your-openai-api-key

# النموذج المستخدم
# gpt-4-turbo-preview = أحدث وأذكى نموذج
# gpt-3.5-turbo = أسرع وأرخص
OPENAI_MODEL=gpt-4-turbo-preview

# الحد الأقصى للـ tokens في كل طلب
# كل token ≈ 4 أحرف إنجليزية أو 1-2 حرف عربي
OPENAI_MAX_TOKENS=4096

# درجة الحرارة (Creativity)
# 0 = ردود محافظة ومتكررة
# 1 = ردود إبداعية ومتنوعة
# 0.7 = توازن جيد
OPENAI_TEMPERATURE=0.7


# ─────────────────────────────────────────────────────────────────────────────
# 💳 الدفع - Stripe (للعملاء الدوليين)
# ─────────────────────────────────────────────────────────────────────────────
#
# Stripe = بوابة دفع دولية
# تدعم: Visa, MasterCard, Apple Pay, Google Pay
#
# للحصول على المفاتيح:
# 1. سجل في: https://stripe.com
# 2. اذهب إلى Developers > API Keys
# ─────────────────────────────────────────────────────────────────────────────

# المفتاح السري (يبدأ بـ sk_)
# sk_test_ للاختبار، sk_live_ للإنتاج
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key

# المفتاح القابل للنشر (يبدأ بـ pk_)
# يُستخدم في الواجهة الأمامية
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key

# المفتاح السري لـ Webhooks
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# العملة الافتراضية
STRIPE_CURRENCY=usd


# ─────────────────────────────────────────────────────────────────────────────
# 💳 الدفع - مُيسّر (Moyasar) للعملاء السعوديين
# ─────────────────────────────────────────────────────────────────────────────
#
# مُيسّر = بوابة دفع سعودية
# تدعم: مدى، Apple Pay، STC Pay، فيزا، ماستركارد
#
# للحصول على المفاتيح:
# 1. سجل في: https://moyasar.com
# 2. اذهب إلى إعدادات API
# ─────────────────────────────────────────────────────────────────────────────

# المفتاح السري
MOYASAR_SECRET_KEY=sk_test_your_moyasar_secret_key

# المفتاح القابل للنشر
MOYASAR_PUBLISHABLE_KEY=pk_test_your_moyasar_publishable_key

# المفتاح السري لـ Webhooks
MOYASAR_WEBHOOK_SECRET=

# العملة الافتراضية (SAR = ريال سعودي)
MOYASAR_CURRENCY=SAR


# ─────────────────────────────────────────────────────────────────────────────
# 📧 البريد الإلكتروني (SMTP)
# ─────────────────────────────────────────────────────────────────────────────
#
# SMTP = بروتوكول إرسال البريد
# يمكنك استخدام:
# - Gmail (للتطوير فقط)
# - SendGrid, Mailgun, SES (للإنتاج)
# ─────────────────────────────────────────────────────────────────────────────

# عنوان خادم SMTP
SMTP_HOST=smtp.gmail.com

# المنفذ
# 587 = TLS (موصى به)
# 465 = SSL
# 25 = بدون تشفير (غير آمن!)
SMTP_PORT=587

# هل نستخدم TLS؟
SMTP_SECURE=false

# اسم المستخدم (عادة البريد الإلكتروني)
SMTP_USER=your-email@gmail.com

# كلمة المرور (أو App Password لـ Gmail)
SMTP_PASS=your-app-password

# البريد المرسل الافتراضي
SMTP_FROM_EMAIL=noreply@rafiq.sa

# اسم المرسل
SMTP_FROM_NAME=Rafiq


# ─────────────────────────────────────────────────────────────────────────────
# 📊 المراقبة والتتبع (Monitoring)
# ─────────────────────────────────────────────────────────────────────────────
#
# Sentry = خدمة لتتبع الأخطاء
# يلتقط الأخطاء تلقائياً ويرسل تنبيهات
# ─────────────────────────────────────────────────────────────────────────────

# رابط DSN لـ Sentry
# احصل عليه من: https://sentry.io
SENTRY_DSN=

# البيئة (development, staging, production)
SENTRY_ENVIRONMENT=development

# هل نفعّل تتبع الأداء؟
SENTRY_TRACES_SAMPLE_RATE=0.1


# ─────────────────────────────────────────────────────────────────────────────
# 🔒 الأمان (Security)
# ─────────────────────────────────────────────────────────────────────────────

# النطاقات المسموح لها بالوصول (CORS)
# * = الكل (للتطوير فقط!)
# للإنتاج: https://rafiq.sa,https://app.rafiq.sa
CORS_ORIGINS=http://localhost:3001,http://localhost:3000

# الحد الأقصى للطلبات في الدقيقة (Rate Limiting)
# يحمي من هجمات DDoS والـ brute force
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# مفتاح تشفير البيانات الحساسة
# يُستخدم لتشفير tokens المحفوظة في قاعدة البيانات
ENCRYPTION_KEY=your-32-character-encryption-key!


# ─────────────────────────────────────────────────────────────────────────────
# 📁 التخزين السحابي (S3-Compatible)
# ─────────────────────────────────────────────────────────────────────────────
#
# يُستخدم لتخزين:
# - صور المنتجات
# - ملفات المحادثات
# - النسخ الاحتياطية
#
# يعمل مع: AWS S3, DigitalOcean Spaces, MinIO, Cloudflare R2
# ─────────────────────────────────────────────────────────────────────────────

# نوع التخزين: local, s3, spaces
STORAGE_DRIVER=local

# مفتاح الوصول
S3_ACCESS_KEY=

# المفتاح السري
S3_SECRET_KEY=

# اسم الـ Bucket
S3_BUCKET=rafiq-storage

# المنطقة (مثال: us-east-1, me-south-1)
S3_REGION=me-south-1

# Endpoint (للخدمات غير AWS)
# مثال لـ DigitalOcean: https://fra1.digitaloceanspaces.com
S3_ENDPOINT=

# رابط CDN للملفات العامة
S3_CDN_URL=


# ─────────────────────────────────────────────────────────────────────────────
# 🧪 إعدادات التطوير والاختبار
# ─────────────────────────────────────────────────────────────────────────────

# هل نفعّل Swagger (API Documentation)؟
SWAGGER_ENABLED=true

# مستوى السجلات
# error = الأخطاء فقط
# warn = تحذيرات وأخطاء
# info = معلومات عامة
# debug = كل شيء (للتطوير)
LOG_LEVEL=debug

# هل نفعّل الـ Debug Mode؟
DEBUG=true
